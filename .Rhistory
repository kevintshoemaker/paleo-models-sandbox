title("old harvest function")
curve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=T),0.01,1.1,
ylab="% of population harvested",xlab="Mammoth density",xaxt="n")
axis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))
title("new harvest function")
# total growth
abundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=F)
growth <- rDD-harv
plot(growth~abundances,main="Overall growth, old",ylab="growth rate",xlab="Mammoth density",type="l")
# total growth
abundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
plot(growth~abundances,main="Overall growth,new",ylab="growth rate",xlab="Mammoth density",type="l")
dimen <- 10
Maxabunds <- seq(625,10000,length=dimen)
Rmaxgens <- seq(1.28,6.84,length=dimen)
HarvG <- 0.4
HarvZs <- seq(1,2,length=dimen)
MaxHarvRates <- seq(0.01,0.4,length=dimen)
# storage variables
allextinct1 <- array(NA,dim=c(dimen,dimen))
allextinct2 <- array(NA,dim=c(dimen,dimen))
allnotextinct1 <- array(NA,dim=c(dimen,dimen))
allnotextinct2 <- array(NA,dim=c(dimen,dimen))
minK  <- array(NA,dim=c(dimen,dimen))
maxK  <- array(NA,dim=c(dimen,dimen))
a=1
for(a in 1:dimen){
MaxHarvRate <- MaxHarvRates[a]
b=1
for(b in 1:dimen){
HarvZ <- HarvZs[b]
allextinct_temp <- array(0,dim=c(dimen,dimen))
extinct_temp <- array(0,dim=c(dimen,dimen))
newK <- array(NA,dim=c(dimen,dimen))
c=1
for(c in 1:dimen){
Maxabund <- Maxabunds[c]
d=1
for(d in 1:dimen){
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
# growth across the range of possible abundances
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
if(any(growth<1)&any(growth>1)){
newK[c,d] <- abundances[which.min(abs(1-growth))]
}
if(all(growth<1)){
allextinct_temp[c,d] <- 1
}
if(growth[1]<1) extinct_temp[c,d] <- 1
}
}
allextinct1[a,b] <- as.numeric(all(extinct_temp==1))
allextinct2[a,b] <- as.numeric(all(allextinct_temp==1))
allnotextinct1[a,b] <- as.numeric(all(extinct_temp==0))
allnotextinct2[a,b] <- as.numeric(all(allextinct_temp==0))
minK[a,b] <- min(newK,na.rm=T)
maxK[a,b] <- max(newK,na.rm=T)
}
}
dimen <- 10
Maxabunds <- seq(625,10000,length=dimen)
Rmaxgens <- seq(1.28,6.84,length=dimen)
HarvG <- 0.4
HarvZs <- seq(1,2,length=dimen)
MaxHarvRates <- seq(0.01,0.4,length=dimen)
# storage variables
allextinct1 <- array(NA,dim=c(dimen,dimen))
allextinct2 <- array(NA,dim=c(dimen,dimen))
allnotextinct1 <- array(NA,dim=c(dimen,dimen))
allnotextinct2 <- array(NA,dim=c(dimen,dimen))
minK  <- array(NA,dim=c(dimen,dimen))
maxK  <- array(NA,dim=c(dimen,dimen))
a=1
for(a in 1:dimen){
MaxHarvRate <- MaxHarvRates[a]
b=1
for(b in 1:dimen){
HarvZ <- HarvZs[b]
allextinct_temp <- array(0,dim=c(dimen,dimen))
extinct_temp <- array(0,dim=c(dimen,dimen))
newK <- array(NA,dim=c(dimen,dimen))
c=1
for(c in 1:dimen){
Maxabund <- Maxabunds[c]
d=1
for(d in 1:dimen){
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
# growth across the range of possible abundances
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
if(any(growth<1)&any(growth>1)){
newK[c,d] <- abundances[which.min(abs(1-growth))]
}
if(all(growth<1)){
allextinct_temp[c,d] <- 1
}
if(growth[1]<1) extinct_temp[c,d] <- 1
}
}
allextinct1[a,b] <- as.numeric(all(extinct_temp==1))
allextinct2[a,b] <- as.numeric(all(allextinct_temp==1))
allnotextinct1[a,b] <- as.numeric(all(extinct_temp==0))
allnotextinct2[a,b] <- as.numeric(all(allextinct_temp==0))
minK[a,b] <- min(newK,na.rm=T)
maxK[a,b] <- max(newK,na.rm=T)
}
}
allextinct1
allnotextinct1
allextinct2 <- array(NA,dim=c(dimen,dimen))
allextinct1 <- array(NA,dim=c(dimen,dimen))
allextinct2 <- array(NA,dim=c(dimen,dimen))
allnotextinct1 <- array(NA,dim=c(dimen,dimen))
allnotextinct2 <- array(NA,dim=c(dimen,dimen))
minK  <- array(NA,dim=c(dimen,dimen))
maxK  <- array(NA,dim=c(dimen,dimen))
a=1
for(a in 1:dimen){
MaxHarvRate <- MaxHarvRates[a]
b=1
for(b in 1:dimen){
HarvZ <- HarvZs[b]
allextinct_temp <- array(0,dim=c(dimen,dimen))
extinct_temp <- array(0,dim=c(dimen,dimen))
newK <- array(NA,dim=c(dimen,dimen))
c=1
for(c in 1:dimen){
Maxabund <- Maxabunds[c]
d=1
for(d in 1:dimen){
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
# growth across the range of possible abundances
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
if(any(growth<1)&any(growth>1)){
newK[c,d] <- abundances[which.min(abs(1-growth))]
}
if(all(growth<1)){
allextinct_temp[c,d] <- 1
}
if(growth[1]<1) extinct_temp[c,d] <- 1
}
}
allextinct1[a,b] <- as.numeric(all(extinct_temp==1))
allextinct2[a,b] <- as.numeric(all(allextinct_temp==1))
allnotextinct1[a,b] <- as.numeric(all(extinct_temp==0))
allnotextinct2[a,b] <- as.numeric(all(allextinct_temp==0))
minK[a,b] <- min(newK,na.rm=T)
maxK[a,b] <- max(newK,na.rm=T)
}
}
allextinct1
allextinct2
a=1
b=1
MaxHarvRate <- MaxHarvRates[a]
HarvZ <- HarvZs[b]
allextinct_temp <- array(0,dim=c(dimen,dimen))
extinct_temp <- array(0,dim=c(dimen,dimen))
newK <- array(NA,dim=c(dimen,dimen))
c=1
HarvZ
MaxHarvRate
c=1
Maxabund <- Maxabunds[c]
d=1
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
c=1
for(c in 1:dimen){
Maxabund <- Maxabunds[c]
d=1
for(d in 1:dimen){
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
# growth across the range of possible abundances
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
# names(growth) <- abundances
# growth
if(any(growth<1)&any(growth>1)){
newK[c,d] <- abundances[which.min(abs(1-growth))]
}
if(all(growth<1)){
allextinct_temp[c,d] <- 1
}
if(growth[1]<1) extinct_temp[c,d] <- 1
}
}
extinct_temp
d=2
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
allextinct1
MaxHarvRates
allnotextinct1
minK[a,b] <- min(newK,na.rm=T)
minK
maxK
dimen <- 10
Maxabunds <- seq(625,10000,length=dimen)
Rmaxgens <- seq(1.28,6.84,length=dimen)
HarvG <- 0.4
HarvZs <- seq(1,2,length=dimen)
MaxHarvRates <- seq(0,0.2,length=dimen)
# storage variables
allextinct1 <- array(NA,dim=c(dimen,dimen))
allextinct2 <- array(NA,dim=c(dimen,dimen))
allnotextinct1 <- array(NA,dim=c(dimen,dimen))
allnotextinct2 <- array(NA,dim=c(dimen,dimen))
minK  <- array(NA,dim=c(dimen,dimen))
maxK  <- array(NA,dim=c(dimen,dimen))
a=1
for(a in 1:dimen){
MaxHarvRate <- MaxHarvRates[a]
b=1
for(b in 1:dimen){
HarvZ <- HarvZs[b]
allextinct_temp <- array(0,dim=c(dimen,dimen))
extinct_temp <- array(0,dim=c(dimen,dimen))
newK <- array(NA,dim=c(dimen,dimen))
c=1
for(c in 1:dimen){
Maxabund <- Maxabunds[c]
d=2
for(d in 1:dimen){
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
# growth across the range of possible abundances
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
# names(growth) <- abundances
# growth
if(any(growth<1)&any(growth>1)){
newK[c,d] <- abundances[which.min(abs(1-growth))]
}
if(all(growth<1)){
allextinct_temp[c,d] <- 1
}
if(growth[1]<1) extinct_temp[c,d] <- 1
}
}
allextinct1[a,b] <- as.numeric(all(extinct_temp==1))
allextinct2[a,b] <- as.numeric(all(allextinct_temp==1))
allnotextinct1[a,b] <- as.numeric(all(extinct_temp==0))
allnotextinct2[a,b] <- as.numeric(all(allextinct_temp==0))
minK[a,b] <- min(newK,na.rm=T)
maxK[a,b] <- max(newK,na.rm=T)
}
}
allextinct1
allnotextinct1
allextinct2
allnotextinct2
minK
maxK
a=2
MaxHarvRate <- MaxHarvRates[a]
b=2
HarvZ <- HarvZs[b]
allextinct_temp <- array(0,dim=c(dimen,dimen))
extinct_temp <- array(0,dim=c(dimen,dimen))
newK <- array(NA,dim=c(dimen,dimen))
c=1
Maxabund <- Maxabunds[c]
d=2
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
any(growth<1)&any(growth>1)
all(growth<1
)
c=1
for(c in 1:dimen){
Maxabund <- Maxabunds[c]
d=2
for(d in 1:dimen){
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
# growth across the range of possible abundances
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
# names(growth) <- abundances
# growth
if(any(growth<1)&any(growth>1)){
newK[c,d] <- abundances[which.min(abs(1-growth))]
}
if(all(growth<1)){
allextinct_temp[c,d] <- 1
}
if(growth[1]<1) extinct_temp[c,d] <- 1
}
}
allextinct1[a,b] <- as.numeric(all(extinct_temp==1))
allextinct2[a,b] <- as.numeric(all(allextinct_temp==1))
allnotextinct1[a,b] <- as.numeric(all(extinct_temp==0))
allnotextinct2[a,b] <- as.numeric(all(allextinct_temp==0))
newK
c=2
Maxabund <- Maxabunds[c]
d=2
Rmaxgen <- Rmaxgens[d]
rmaxann <- Rmaxgen^(1/25)
abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
allextinct1
minK
allnotextinct1
harvfunc <- function(mhr,g,z,d,new=TRUE){
if(new){
ifelse(d>0,((mhr*d^z)/(g+d^z))/d,0)
}else{
(mhr*d^z)/(g+d^z)
}
}
ddfunc_contest <- function(N,rmax,K){
rmax * K / (rmax * N - N + K)
}
##############
# PARAMS
##############
Maxabund <- 10000    ## range: 625 to 10000
Rmaxgen <- 4.5        ## 1.28 to 6.84
HarvG <- 0.4      # always 0.4
HarvZ <- 1        ## 1 to 2
MaxHarvRate <- 0.01    ## ???  # max prey consumption rate, as fraction of the total possible mammoth abundance
rmaxann <- Rmaxgen^(1/25)
rmaxann
harvfunc(MaxHarvRate,HarvG,HarvZ,1,new=TRUE)  # at K
harvfunc(MaxHarvRate,HarvG,HarvZ,0.5,new=TRUE)  # at K
harvfunc(MaxHarvRate,HarvG,HarvZ,0.1,new=TRUE)  # at K
curve(ddfunc_contest(x,rmaxann,Maxabund/2),0,Maxabund,
ylab="growth rate",xlab="Mammoth density")
title("contest density dependence")
par(mfrow=c(2,2))
curve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=F),0.01,1.1,
ylab="% of population harvested",xlab="Mammoth density",xaxt="n")
axis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))
title("old harvest function")
curve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=T),0.01,1.1,
ylab="% of population harvested",xlab="Mammoth density",xaxt="n")
axis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))
title("new harvest function")
abundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=F)
growth <- rDD-harv
plot(growth~abundances,main="Overall growth, old",ylab="growth rate",xlab="Mammoth density",type="l")
abundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
plot(growth~abundances,main="Overall growth,new",ylab="growth rate",xlab="Mammoth density",type="l")
rmaxann <- Rmaxgen^(1/25)
rmaxann
abundances <- seq(10,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- abundances[which.min(abs(1-growth))]
newK
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- abundances[which.min(abs(1-growth))]
newK
HarvZ <- 2       ## 1 to 2
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- abundances[which.min(abs(1-growth))]
newK
MaxHarvRate <- 0.05    ## ???  # max prey consumption rate, as fraction of the total possible mammoth abundance
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- abundances[which.min(abs(1-growth))]
newK
HarvZ <- 1       ## 1 to 2
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- abundances[which.min(abs(1-growth))]
newK
HarvZ <- 1       ## 1 to 2
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- abundances[which.min(abs(1-growth))]
newK
HarvZ <- 1       ## 1 to 2
HarvG <- 0.4      # always 0.4
Maxabund <- 10000    ## range: 625 to 10000
Rmaxgen <- 4.5        ## 1.28 to 6.84
Maxabund <- 10000    ## range: 625 to 10000
Rmaxgen <- 4.5        ## 1.28 to 6.84
HarvG <- 0.4      # always 0.4
HarvZ <- 1       ## 1 to 2
MaxHarvRate <- 0.05    ## ???  # max prey consumption rate, as fraction of the total possible mammoth abundance
rmaxann <- Rmaxgen^(1/25)
rmaxann
harvfunc(MaxHarvRate,HarvG,HarvZ,1,new=TRUE)  # at K
harvfunc(MaxHarvRate,HarvG,HarvZ,0.5,new=TRUE)  # at K
harvfunc(MaxHarvRate,HarvG,HarvZ,0.1,new=TRUE)  # at K
# visualize density dependence
curve(ddfunc_contest(x,rmaxann,Maxabund/2),0,Maxabund,
ylab="growth rate",xlab="Mammoth density")
title("contest density dependence")
# visualize harvest rates over densities
par(mfrow=c(2,2))
curve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=F),0.01,1.1,
ylab="% of population harvested",xlab="Mammoth density",xaxt="n")
axis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))
title("old harvest function")
curve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=T),0.01,1.1,
ylab="% of population harvested",xlab="Mammoth density",xaxt="n")
axis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))
title("new harvest function")
# total growth
abundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=F)
growth <- rDD-harv
plot(growth~abundances,main="Overall growth, old",ylab="growth rate",xlab="Mammoth density",type="l")
# total growth
abundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
plot(growth~abundances,main="Overall growth,new",ylab="growth rate",xlab="Mammoth density",type="l")
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- ifelse(any(growth>1)&any(growth<1), abundances[which.min(abs(1-growth))],0)
newK
HarvZ <- 1.5       ## 1 to 2
abundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   #
rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)
harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)
growth <- rDD-harv
names(growth) <- abundances
growth
newK <- ifelse(any(growth>1)&any(growth<1), abundances[which.min(abs(1-growth))],0)
newK

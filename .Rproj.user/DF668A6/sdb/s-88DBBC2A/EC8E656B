{
    "collab_server" : "",
    "contents" : "\n\n############\n# TEST THE DLL\n############\n\nharvfunc <- function(mhr,g,z,d,new=TRUE){\n  if(new){\n    ifelse(d>0,((mhr*d^z)/(g+d^z))/d,0)\n  }else{\n    (mhr*d^z)/(g+d^z)\n  }\n}\n\nddfunc_contest <- function(N,rmax,K){\n  rmax * K / (rmax * N - N + K)   \n}\n\n\n##############\n# PARAMS\n##############\n\nMaxabund <- 10000    ## range: 625 to 10000\n\nRmaxgen <- 4.5        ## 1.28 to 6.84\n\nHarvG <- 0.4      # always 0.4\n\nHarvZ <- 1.5       ## 1 to 2\n\nMaxHarvRate <- 0.05    ## ???  # max prey consumption rate, as fraction of the total possible mammoth abundance\n\n\n##############\n# DERIVED TERMS\n##############\n\n\nrmaxann <- Rmaxgen^(1/25)\nrmaxann\n\n\n##############\n# RUN FUNCTIONS\n##############\n\nharvfunc(MaxHarvRate,HarvG,HarvZ,1,new=TRUE)  # at K\n\nharvfunc(MaxHarvRate,HarvG,HarvZ,0.5,new=TRUE)  # at K\n\nharvfunc(MaxHarvRate,HarvG,HarvZ,0.1,new=TRUE)  # at K\n\n##############\n# VISUALIZE FUNCTIONS\n##############\n\n# visualize density dependence\ncurve(ddfunc_contest(x,rmaxann,Maxabund/2),0,Maxabund,\n      ylab=\"growth rate\",xlab=\"Mammoth density\")\ntitle(\"contest density dependence\")\n\n\n  # visualize harvest rates over densities\npar(mfrow=c(2,2))\ncurve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=F),0.01,1.1,\n       ylab=\"% of population harvested\",xlab=\"Mammoth density\",xaxt=\"n\")\naxis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))\ntitle(\"old harvest function\")\n\ncurve(harvfunc(MaxHarvRate,HarvG,HarvZ,x,new=T),0.01,1.1,\n       ylab=\"% of population harvested\",xlab=\"Mammoth density\",xaxt=\"n\")\naxis(1,at=seq(0.01,1.1,0.1),labels=c(seq(0.01*Maxabund,1.1*Maxabund,0.1*Maxabund)))\ntitle(\"new harvest function\")\n\n\n\n  # total growth\nabundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   # \nrDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)\nharv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=F)\ngrowth <- rDD-harv\n\nplot(growth~abundances,main=\"Overall growth, old\",ylab=\"growth rate\",xlab=\"Mammoth density\",type=\"l\")\n\n\n# total growth\nabundances <- seq(10,Maxabund*1.1,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   # \nrDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)\nharv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)\ngrowth <- rDD-harv\n\nplot(growth~abundances,main=\"Overall growth,new\",ylab=\"growth rate\",xlab=\"Mammoth density\",type=\"l\")\n\n##############\n# ANNUAL GROWTH WITH BOTH PROCESSES\n##############\n\nabundances <- seq(10,Maxabund,1)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   # \n\nrDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)\n\nharv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)\n\n\ngrowth <- rDD-harv\nnames(growth) <- abundances\ngrowth\n\nnewK <- ifelse(any(growth>1)&any(growth<1), abundances[which.min(abs(1-growth))],0)\n\nnewK\n\n##############\n# PARAM SPACE TO SEARCH\n##############\n\ndimen <- 10\n\nMaxabunds <- seq(625,10000,length=dimen)\n\nRmaxgens <- seq(1.28,6.84,length=dimen)\n\nHarvG <- 0.4       \n\nHarvZs <- seq(1,2,length=dimen)\n\nMaxHarvRates <- seq(0,0.2,length=dimen)\n\n   # storage variables\n\nallextinct1 <- array(NA,dim=c(dimen,dimen))\nallextinct2 <- array(NA,dim=c(dimen,dimen))\nallnotextinct1 <- array(NA,dim=c(dimen,dimen))\nallnotextinct2 <- array(NA,dim=c(dimen,dimen))\nminK  <- array(NA,dim=c(dimen,dimen))\nmaxK  <- array(NA,dim=c(dimen,dimen))\n\na=2\nfor(a in 1:dimen){\n  MaxHarvRate <- MaxHarvRates[a]\n  b=2\n  for(b in 1:dimen){\n    HarvZ <- HarvZs[b]\n    allextinct_temp <- array(0,dim=c(dimen,dimen))\n    extinct_temp <- array(0,dim=c(dimen,dimen)) \n    newK <- array(NA,dim=c(dimen,dimen))\n    c=2\n    for(c in 1:dimen){\n      Maxabund <- Maxabunds[c]\n      d=2\n      for(d in 1:dimen){\n        Rmaxgen <- Rmaxgens[d]\n        rmaxann <- Rmaxgen^(1/25)\n\n             # growth across the range of possible abundances\n        abundances <- seq(1,Maxabund,10)  # <- c(1000,1000,753,720,727,762,725,709,733,748)   # \n        rDD <-  ddfunc_contest(abundances,rmaxann,Maxabund/2)\n        harv <- harvfunc(MaxHarvRate,HarvG,HarvZ,abundances/Maxabund,new=T)\n        growth <- rDD-harv\n        # names(growth) <- abundances\n        # growth\n        if(any(growth<1)&any(growth>1)){\n          newK[c,d] <- abundances[which.min(abs(1-growth))]\n        }\n        if(all(growth<1)){\n          allextinct_temp[c,d] <- 1\n        }\n        if(growth[1]<1) extinct_temp[c,d] <- 1\n      }\n    }\n    allextinct1[a,b] <- as.numeric(all(extinct_temp==1)) \n    allextinct2[a,b] <- as.numeric(all(allextinct_temp==1))\n    allnotextinct1[a,b] <- as.numeric(all(extinct_temp==0)) \n    allnotextinct2[a,b] <- as.numeric(all(allextinct_temp==0))\n    minK[a,b] <- min(newK,na.rm=T)\n    maxK[a,b] <- max(newK,na.rm=T)\n  }\n}\n\nallextinct1\nallnotextinct1\nallextinct2\nallnotextinct2\nminK\nmaxK\n\n",
    "created" : 1496764907437.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "296028895",
    "id" : "EC8E656B",
    "lastKnownWriteTime" : 1497027566,
    "last_content_update" : 1497027566028,
    "path" : "E:/Dropbox/Damien Fordham/Mammoth Model/rscripts/testdll.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}